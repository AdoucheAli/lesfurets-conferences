<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Live code review at LesFurets.com</title>
    <meta name="description" content="Live code review at LesFurets.com">
    <meta name="author" content="Alexandre DuBreuil, Jeremy Maltis">
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" href="bower_components/reveal.js/css/reveal.css">
    <link rel="stylesheet" href="bower_components/reveal.js/lib/css/zenburn.css">
    <link rel="stylesheet" href="css/lesfurets-theme.css" id="theme">
    <link rel="stylesheet" href="css/live-code-review-theme.css" id="theme">
    <script>
      if( window.location.search.match( /print-pdf/gi ) ) {
        var link = document.createElement( 'link' );
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = 'css/print/pdf.css';
        document.getElementsByTagName( 'head' )[0].appendChild( link );
      }
    </script>
    <!--[if lt IE 9]><script src="lib/js/html5shiv.js"></script><![endif]-->
  </head>
  <body>
    <div id="footer" class="footer show">
      <a href="https://www.lesfurets.com" target="_blank"><img class="logo" src="img/logo_lesfurets_885x128_no_back.png"></a><a class ="github" href="https://github.com/lesfurets" target="_blank">TODO</a><a class="twitter" href="https://twitter.com/BeastieFurets" target="_blank">@TODO</a>
    </div>
    <div class="reveal">
      <div class="slides">
      <!-- START -->

      <section class="flushright" data-background="img/nwx/lesfurets-background-black-01.jpg">
        <h1>Live code review<br/> at LesFurets.com</h1>
        <h2>Alexandre DuBreuil</h2>
        <h2>Jeremy Maltis</h2>
      </section>

      <section class="flushleft"  data-background="img/nwx/lesfurets-background-black-01.jpg">
        <h2>Alexandre DuBreuil</h2>
        <h3 class="fragment">Tech lead team insurer panel</h3>
        <ul class="flushright nodisc">
          <li class="fragment">
            <a style="color:white" href="https://twitter.com/dubreuia">https://twitter.com/dubreuia</a>
          </li>
          <li class="fragment">
            <a style="color:white" href="https://github.com/dubreuia">https://github.com/dubreuia</a>
          </li>
        </ul>
        <h2>Jeremy Maltis</h2>
        <h3 class="fragment">Front developer team journey</h3>
        <ul class="flushright nodisc">
          <li class="fragment">
            <a style="color:white" href="TODO">TODO</a>
          </li>
          <li class="fragment">
            <a style="color:white" href="TODO">TODO</a>
          </li>
        </ul>
      </section>

      <section class="flushleft" data-background="#222222">
        <h2>What do we review</h2>
        <ul class="white">
          <li>Style / naming</li>
          <li>Language and API usage</li>
          <li>Simplicity</li>
          <li>Object oriented programming</li>
          <li>Other things that fits your team</li>
        </ul>
      </section>

      <section class="flushleft" data-background="#333">
        <h2>How / when do you do it</h2>
        <div>TODO graph</div>
        <div>code -&gt; CR + proposition -&gt; correction -&gt; cycle !</div>
      </section>

      <!-- CODE STYLE / NAMING -->

      <section class="flushleft" data-background="#eee">
        <h2 style="color:#333">Code style and naming</h2>
      </section>

      <section class="flushleft" data-background="#333">
        <h3 class="center">Style and naming</h3>
        <div class="code-wrapper">
        <pre><code class="code java" data-trim data-noescape>
void check(MainDriver d1, Driver d2, Besoins b) 
                        throws ExclusionException {

  int age = DateHelper.getAge(driver.getBirthDate(),
  DateHelper.getToday(),
  EPrecision.day);

  if (age < 18)
      throw new ExclusionException("Must be at least " 
                                   + "18 years old");
}
        </code></pre>
        </div>
      </section>

      <section class="flushleft" data-background="#333">
        <h3 class="center">Review style and naming</h3>
        <div class="code-wrapper">
        <pre><code class="code java" data-trim data-noescape>
<mark>// Use precise method naming, parameter naming,</mark>
<mark>// and remove unused parameters</mark>
void check(MainDriver d1, Driver d2, Besoins b) 
                        throws ExclusionException {
  <mark>// Use static imports if clearer and correct indentation</mark>
  int age = DateHelper.getAge(driver.getBirthDate(),
  DateHelper.getToday(),
  EPrecision.day);
  <mark>// Use constants for magic numbers and string</mark>
  if (age < 18)
      <mark>// Use brackets for single line statements</mark>
      throw new ExclusionException("Must be at least " 
                                   + "18 years old");
}
        </code></pre>
        </div>
      </section>

      <section class="flushleft" data-background="#333">
        <h3 class="center">Correct style and naming</h3>
        <div class="code-wrapper">
        <pre><code class="code java" data-trim data-noescape>
// Use precise method naming, parameter naming, 
// and remove unused parameters
void <mark>checkMainDriverAge</mark>(MainDriver <mark>mainDriver</mark>, 
                               Besoins <mark>besoins</mark>) 
                                   throws ExclusionException {
  // Use static imports if clearer
  int age = <mark>getAge</mark>(driver.getBirthDate(), <mark>getToday()</mark>, 
                   EPrecision.day);
  // Use constants for magic numbers and string
  if (age < <mark>MINIMUM_AGE</mark>) <mark>{</mark>
      // Use brackets for single line statements
      throw new ExclusionException(<mark>EXCLUSION_MESSAGE_18_YEARS</mark>);
  <mark>}</mark>
}
        </code></pre>
        </div>
      </section>

      <section class="flushleft" data-background="#333">
        <h3>Style and naming wrapup</h3>
        <ul class="white">
          <li>Define a style guide and naming rules with your team...</li>
          <li>&nbsp;&nbsp;&nbsp;&nbsp;...and stick to it !</li>
          <li>https://google.github.io/styleguide/cppguide.html</li>
          <li>Some of it can be automated:</li>
          <li>&nbsp;&nbsp;&nbsp;&nbsp;<em>Eclipse:</em> settings -&gt; save-actions</li>
          <li>&nbsp;&nbsp;&nbsp;&nbsp;<em>Intellij:</em> plugins -&gt; save-actions (TODO link)</li>
          <li>&nbsp;&nbsp;&nbsp;&nbsp;<em>Sonar:</em> static code analysis</li>
        </ul>
      </section>

      <!-- LANGUAGE AND API USAGE -->

      <section class="flushleft" data-background="#eee">
        <h2 style="color:#333">Language and API usage</h2>
      </section>

      <section class="flushleft" data-background="#333">
        <h3 class="center">Language and API usage</h3>
        <div class="code-wrapper">
        <pre><code class="code java" data-trim data-noescape>
Collection&lt;Object&gt; removeDuplicates(Collection&lt;?&gt; collection) {
    List&lt;Object&gt; uniques = new ArrayList&lt;&gt;();
    for (Object object : collection)
        if (!uniques.contains(object))
            uniques.add((object));
    return uniques;
}

TODO
        </code></pre>
        </div>
      </section>

      <section class="flushleft" data-background="#333">
        <h3 class="center">Review language and API usage</h3>
        <div class="code-wrapper">
        <pre><code class="code java" data-trim data-noescape>
Collection&lt;Object&gt; removeDuplicates(Collection&lt;?&gt; collection) {
    <mark>// Use a set to remove duplicates</mark>
    List&lt;Object&gt; uniques = new ArrayList&lt;&gt;();
    for (Object object : collection)
        if (!uniques.contains(object))
            uniques.add(object);
    return uniques;
}

TODO
        </code></pre>
        </div>
      </section>

      <section class="flushleft" data-background="#333">
        <h3 class="center">Correct language and API usage</h3>
        <div class="code-wrapper">
        <pre><code class="code java" data-trim data-noescape>
Collection&lt;Object&gt; removeDuplicates(Collection&lt;?&gt; collection) {
    // Use a set to remove duplicates
    return <mark>new HashSet&lt;&gt;(collection)</mark>;
}

TODO
        </code></pre>
        </div>
      </section>

      <section class="flushleft" data-background="#333">
        <h3>Language and API wrapup</h3>
        <ul class="white">
          <li>Know your langage inside out</li>
          <li>Create your own methods if needed</li>
          <li>Some of it can be automated:</li>
          <li>&nbsp;&nbsp;&nbsp;&nbsp;Eclipse and Intellij have warnings</li>
          <li>&nbsp;&nbsp;&nbsp;&nbsp;Sonar can have custom rules</li>
        </ul>
      </section>

      <!-- SIMPLICITY -->

      <section class="flushleft" data-background="#eee">
        <h2 style="color:#333">Simplicity</h2>
      </section>

      <section class="flushleft" data-background="#333">
        <h3 class="center">Simplicity</h3>
        <div class="code-wrapper">
        <pre><code class="code java" data-trim data-noescape>
private boolean isPreviousVersion(String version, String compareWith) {
    String[] versionDigits = compare.split("\\.");
    String[] compareDigits = compareWith.split("\\.");
    if (Integer.valueOf(versionDigits[0]) < Integer.valueOf(compareDigits[0]))
        return true;
    else if (Integer.valueOf(versionDigits[0]) == Integer.valueOf(compareDigits[0])) {
        if (Integer.valueOf(versionDigits[1]) < Integer.valueOf(compareDigits[1]))
            return true;
        else {
            if (Integer.valueOf(versionDigits[1]) == Integer.valueOf(compareDigits[1])) {
                return Integer.valueOf(versionDigits[2]) < Integer.valueOf(compareDigits[2]);
            }
            return false;
        }
    }
    return false;
}
        </code></pre>
        </div>
      </section>

      <section class="flushleft" data-background="#333">
        <h3 class="center">Review simplicity</h3>
        <div class="code-wrapper">
        <pre><code class="code java" data-trim data-noescape>
private boolean isPreviousVersion(String version, String compareWith) {
    String[] versionDigits = compare.split("\\.");
    String[] compareDigits = compareWith.split("\\.");
    if (Integer.valueOf(versionDigits[0]) < Integer.valueOf(compareDigits[0]))
        return true;
    <mark>// Do not compare Integer with == (it only works up to 127), use equals instead</mark>
    else if (Integer.valueOf(versionDigits[0]) == Integer.valueOf(compareDigits[0])) {
        if (Integer.valueOf(versionDigits[1]) < Integer.valueOf(compareDigits[1]))
            return true;
        else {
            <mark>// Exact same behaviour as above, use private method</mark>
            if (Integer.valueOf(versionDigits[1]) == Integer.valueOf(compareDigits[1])) {
                return Integer.valueOf(versionDigits[2]) < Integer.valueOf(compareDigits[2]);
            }
            return false;
        }
    }
    <mark>// A lot of return statement, isn't there a simplier way ?</mark>
    return false;
}
<mark>// General remark : you only compare the first 3 numbers ?</mark>
        </code></pre>
        </div>
      </section>

      <section class="flushleft" data-background="#333">
        <h3 class="center">Correct simplicity</h3>
        <div class="code-wrapper">
        <pre><code class="code java" data-trim data-noescape>
private boolean isPreviousVersion(String version, String compareWith) {
    String[] versionDigits = compare.split("\\.");
    String[] compareDigits = compareWith.split("\\.");
    // General remark : you only compare the first 3 numbers ?
    <mark>for (int i = 0; i < versionDigits.length; i++) {</mark>
        // Exact same behaviour as above, use private method
        <mark>if (isSameVersion(versionDigits[i], compareDigits[i])) {</mark>
            continue;
        }
        return isPreviousVersion(versionDigits[i], compareDigits[i]);
    }
    // A lot of return statement, isn't there a simplier way ?
    <mark>return false;</mark>
}
    </code></pre>
      </section>

      <section class="flushleft" data-background="#333">
        <h3 class="center">Simplicity wrapup</h3>
        <ul class="white">
          <li>A method should be simple to read/understand</li>
          <li>&nbsp;&nbsp;&nbsp;&nbsp;When you're done coding a method, read yourself again
          <li>Beware of nested if and loops</li>
          <li>&nbsp;&nbsp;&nbsp;&nbsp;It never smells good...</li>
          <li>Do not duplicate code, use private methods</li>
          <li>Could refer to Sonar complexity metric</li>
        </ul>
      </section>

      <!-- OBJECT ORIENTED PROGRAMMING -->

      <section class="flushleft" data-background="#eee">
        <h2 style="color:#333">Object Oriented Programming (OOP)</h2>
      </section>

      <section class="flushleft" data-background="#333">
        <h3 class="center">Object Oriented Programming</h3>
        <div class="code-wrapper">
        <pre><code class="code java" data-trim data-noescape>
public BigDecimal recomputePrice(Quote quote) throws ComputationPriceException {
  BigDecimal quoteTotalPrice;
  quoteTotalPrice = new BigDecimal(quote.getPrice().doubleValue());
  if (quote.getWarrantyAvailability1().equals(quote.getQuoteType())) {
      quoteTotalPrice = quoteTotalPrice.add(quote.getWarrantyPrice1());
  }
  if (quote.getWarrantyAvailability2().equals(quote.getQuoteType())) {
      quoteTotalPrice = quoteTotalPrice.add(quote.getWarrantyPrice2());
  }
  if (quote.getExpirationDate().isBefore(LocalDate.now())) {
      throw new ComputationPriceException("It's too late !");
  }
  if (!quote.isFeesIncluded()) {
      if (quote.getOneTimeFees() != null) {
          quoteTotalPrice = quoteTotalPrice.add(quote.getOneTimeFees());
      }
      if (quote.getAnnualFees() != null) {
          quoteTotalPrice = quoteTotalPrice.add(quote.getAnnualFees());
      }
  }
  // Taxes has changed after 1st January 2015
  if (quote.getDate().isBefore(LocalDate.of(2015, 1, 1))) {
      quoteTotalPrice = quoteTotalPrice.multiply(new BigDecimal(1.20));
  } else {
      quoteTotalPrice = quoteTotalPrice.multiply(new BigDecimal(1.196));
  }
  // Rounding
  return quoteTotalPrice.setScale(2, BigDecimal.ROUND_HALF_UP);
}
    </code></pre>
      </section>

      <section class="flushleft" data-background="#333">
        <h3 class="center">Review Object Oriented Programming</h3>
        <div class="code-wrapper">
        <pre><code class="code java" data-trim data-noescape>
public BigDecimal recomputePrice(Quote quote) throws ComputationPriceException {
  BigDecimal quoteTotalPrice;
  <mark>// Variables with numbers is rarely a good option, use a list instead ?</mark>
  <mark>// Warranties look independant from the quote, encapsulate in an object</mark>
  quoteTotalPrice = new BigDecimal(quote.getPrice().doubleValue());
  if (quote.getWarrantyAvailability1().equals(quote.getQuoteType())) {
      quoteTotalPrice = quoteTotalPrice.add(quote.getWarrantyPrice1());
  }
  if (quote.getWarrantyAvailability2().equals(quote.getQuoteType())) {
      quoteTotalPrice = quoteTotalPrice.add(quote.getWarrantyPrice2());
  }
  <mark>// Exception check at the beginning if possible</mark>
  if (quote.getExpirationDate().isBefore(LocalDate.now())) {
      throw new ComputationPriceException("It's too late !");
  }
  <mark>// Fees in a separate object</mark>
  if (!quote.isFeesIncluded()) {
      if (quote.getOneTimeFees() != null) {
          quoteTotalPrice = quoteTotalPrice.add(quote.getOneTimeFees());
      }
      if (quote.getAnnualFees() != null) {
          quoteTotalPrice = quoteTotalPrice.add(quote.getAnnualFees());
      }
  }
  <mark>// Extract taxes in a separate service, quote doesn't really have to know how they're calculated</mark>
  // Taxes has changed after 1st January 2015
  if (quote.getDate().isBefore(LocalDate.of(2015, 1, 1))) {
      quoteTotalPrice = quoteTotalPrice.multiply(new BigDecimal(1.20));
  } else {
      quoteTotalPrice = quoteTotalPrice.multiply(new BigDecimal(1.196));
  }
  // Rounding
  return quoteTotalPrice.setScale(2, BigDecimal.ROUND_HALF_UP);
}
    </code></pre>
      </section>

      <section class="flushleft" data-background="#333">
        <h3 class="center">Correct Object Oriented Programming</h3>
        <div class="code-wrapper">
        <pre><code class="code java" data-trim data-noescape>
public BigDecimal recomputePrice(Quote quote) throws ComputationPriceException {
  // Exception check at the beginning if possible
  <mark>checkQuoteIsStillValid(quote.getExpirationDate(), quote.getInsurer());</mark>

  // Independant objects
  BigDecimal quoteTotalPrice = new BigDecimal(quote.getPrice().doubleValue())
                  .add(warrantyService.computeWarrantiesAmount(quote.getQuoteType(), <mark>quote.getWarranties()</mark>))
                  .add(feesService.computeFeesAmount(<mark>quote.getFees()</mark>));

  // Extract taxes in a separate service, quote doesn't really have to know how they're calculated
  return <mark>taxesService</mark>.applyTaxes(quote.getDate(), quoteTotalPrice);
}
        </code></pre>
      </section>

      <section class="flushleft" data-background="#333">
        <h3 class="center">Object Oriented Programming Class Diagram</h3>
        <ul class="white">
          <img src="img/class-diagram.png" />
        </ul>
      </section>

      <section class="flushleft" data-background="#333">
        <h3 class="center">Object Oriented Programming wrapup</h3>
        <ul class="white">
          <li>Encapsulation, inheritance, abstraction, polymorphism</li>
          <li>No god object</li>
          <li>&nbsp;&nbsp;&nbsp;&nbsp;Don't be afraid of creating new classes</li>
          <li>No duplication in objects</li>
          <li>&nbsp;&nbsp;&nbsp;&nbsp;Don't forget inheritance when necessary</li>
          <li>Structure your data in a smart way</li>
        </ul>
      </section>
      <!-- CONCLUSION -->

      <section class="flushleft" data-background="#333">
        <h3>Why do we do code review</h3>
        <ul class="white">
          <li>Quality: uniformity, best practices, style</li>
          <li>Communication: bus factor, discussions, sharing</li>
          <li>Documentation: basis for argumentation, identifying specific code smells</li>
          <li>Bugs: reduce bugs</li>
        </ul>
      </section>

      <section class="flushleft" data-background="#333">
        <h3>Who does code review</h3>
        <ul class="white">
          <li>Junior developers (simplicity)</li>
          <li>Senior developers (design / oop / language)</li>
          <li>Everybody !</li>
        </ul>
      </section>

      <section class="flushleft" data-background="#333">
        <h3>TODO</h3>
        <ul class="white">
          <li>TODO tests unitaires</li>
          <li>TODO compréhension</li>
          <li>TODO anti pattern et code smell</li>
          <li>TODO avoid shaming</li>
        </ul>
      </section>

      <section class="flushleft" data-background="#333">
        <h3>END</h3>
      </section>

      <!-- END -->
      </div>
    </div>
    <script src="bower_components/reveal.js/lib/js/head.min.js"></script>
    <script src="bower_components/reveal.js/js/reveal.js"></script>
    <script>
      // Full list of configuration options available here:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        controls: true,
        progress: true,
        history: true,
        center: true,
        embedded: true,

        //theme: 'lesfurets', // available themes are in /css/theme
        transition: Reveal.getQueryHash().transition || 'linear', // default/cube/page/concave/zoom/linear/fade/none

        // Parallax scrolling
        // parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
        // parallaxBackgroundSize: '2100px 900px',

        // Optional libraries used to extend on reveal.js
        dependencies: [
          { src: 'bower_components/reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
          { src: 'bower_components/reveal.js/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
          { src: 'bower_components/reveal.js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
          { src: 'bower_components/reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
          { src: 'bower_components/reveal.js/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
          { src: 'bower_components/reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
        ]
      });
    </script>
    <script src="js/lesfurets-theme.js" async></script>
  </body>
</html>
